// Working file for multiple Weeks... //

var fs = require('fs');
var request = require ('request'),
    cheerio = require('cheerio'),
    chart = [];    

weeks = {
"24-May-14":41784,
"17-May-14":41777,
"10-May-14":41770,
"3-May-14":41763,
"26-Apr-14":41756,
"19-Apr-14":41749,
"12-Apr-14":41742,
"5-Apr-14":41735,
"29-Mar-14":41728,
"22-Mar-14":41721,
"15-Mar-14":41714,
"8-Mar-14":41707,
"1-Mar-14":41700,
"22-Feb-14":41693,
"15-Feb-14":41686,
"8-Feb-14":41679,
"1-Feb-14":41672,
"25-Jan-14":41665,
"18-Jan-14":41658,
"11-Jan-14":41651,
"4-Jan-14":41644,
"28-Dec-13":41637,
"21-Dec-13":41630,
"14-Dec-13":41623,
"7-Dec-13":41616,
"30-Nov-13":41609,
"23-Nov-13":41602,
"16-Nov-13":41595,
"9-Nov-13":41588,
"2-Nov-13":41581,
"26-Oct-13":41574,
"19-Oct-13":41567,
"12-Oct-13":41560,
"5-Oct-13":41553,
"28-Sep-13":41546,
"21-Sep-13":41539,
"14-Sep-13":41532,
"7-Sep-13":41525,
"31-Aug-13":41518,
"24-Aug-13":41511,
"17-Aug-13":41504,
"10-Aug-13":41497,
"3-Aug-13":41490,
"27-Jul-13":41483,
"20-Jul-13":41476,
"13-Jul-13":41469,
"6-Jul-13":41462,
"29-Jun-13":41455,
"22-Jun-13":41448,
"15-Jun-13":41441,
"8-Jun-13":41434,
"1-Jun-13":41427,
"25-May-13":41420,
"18-May-13":41413,
"11-May-13":41406,
"4-May-13":41399,
"27-Apr-13":41392,
"20-Apr-13":41385,
"13-Apr-13":41378,
"6-Apr-13":41371,
"30-Mar-13":41364,
"23-Mar-13":41357,
"16-Mar-13":41350,
"9-Mar-13":41343,
"2-Mar-13":41336,
"23-Feb-13":41329,
"16-Feb-13":41322,
"9-Feb-13":41315,
"2-Feb-13":41308,
"26-Jan-13":41301,
"19-Jan-13":41294,
"12-Jan-13":41287,
"5-Jan-13":41280,
"29-Dec-12":41273,
"22-Dec-12":41266,
"15-Dec-12":41259,
"8-Dec-12":41252,
"1-Dec-12":41245,
"24-Nov-12":41238,
"17-Nov-12":41231,
"10-Nov-12":41224,
"3-Nov-12":41217,
"27-Oct-12":41210,
"20-Oct-12":41203,
"13-Oct-12":41196,
"6-Oct-12":41189,
"29-Sep-12":41182,
"22-Sep-12":41175,
"15-Sep-12":41168,
"8-Sep-12":41161,
"1-Sep-12":41154,
"25-Aug-12":41147,
"18-Aug-12":41140,
"11-Aug-12":41133,
"4-Aug-12":41126,
"28-Jul-12":41119,
"21-Jul-12":41112,
"14-Jul-12":41105,
"7-Jul-12":41098,
"30-Jun-12":41091,
"23-Jun-12":41084,
"16-Jun-12":41077,
"9-Jun-12":41070,
"2-Jun-12":41063,
"26-May-12":41056,
"19-May-12":41049,
"12-May-12":41042,
"5-May-12":41035,
"28-Apr-12":41028,
"21-Apr-12":41021,
"14-Apr-12":41014,
"7-Apr-12":41007,
"31-Mar-12":41000,
"24-Mar-12":40993,
"17-Mar-12":40986,
"10-Mar-12":40979,
"3-Mar-12":40972,
"25-Feb-12":40965,
"18-Feb-12":40958,
"11-Feb-12":40951,
"4-Feb-12":40944,
"28-Jan-12":40937,
"21-Jan-12":40930,
"14-Jan-12":40923,
"7-Jan-12":40916,
"31-Dec-11":40909,
"24-Dec-11":40902,
"17-Dec-11":40895,
"10-Dec-11":40888,
"3-Dec-11":40881,
"26-Nov-11":40874,
"19-Nov-11":40867,
"12-Nov-11":40860,
"5-Nov-11":40853,
"29-Oct-11":40846,
"22-Oct-11":40839,
"15-Oct-11":40832,
"8-Oct-11":40825,
"1-Oct-11":40818,
"24-Sep-11":40811,
"17-Sep-11":40804,
"10-Sep-11":40797,
"3-Sep-11":40790,
"27-Aug-11":40783,
"20-Aug-11":40776,
"13-Aug-11":40769,
"6-Aug-11":40762,
"30-Jul-11":40755,
"23-Jul-11":40748,
"16-Jul-11":40741,
"9-Jul-11":40734,
"2-Jul-11":40727,
"25-Jun-11":40720,
"18-Jun-11":40713,
"11-Jun-11":40706,
"4-Jun-11":40699,
"28-May-11":40692,
"21-May-11":40685,
"14-May-11":40678,
"7-May-11":40671,
"30-Apr-11":40664,
"23-Apr-11":40657,
"16-Apr-11":40650,
"9-Apr-11":40643,
"2-Apr-11":40636,
"26-Mar-11":40629,
"19-Mar-11":40622,
"12-Mar-11":40615,
"5-Mar-11":40608,
"26-Feb-11":40601,
"19-Feb-11":40594,
"12-Feb-11":40587,
"5-Feb-11":40580,
"29-Jan-11":40573,
"22-Jan-11":40566,
"15-Jan-11":40559,
"8-Jan-11":40552,
"1-Jan-11":40545,
"25-Dec-10":40538,
"18-Dec-10":40531,
"11-Dec-10":40524,
"4-Dec-10":40517,
"27-Nov-10":40510,
"20-Nov-10":40503,
"13-Nov-10":40496,
"6-Nov-10":40489,
"30-Oct-10":40482,
"23-Oct-10":40475,
"16-Oct-10":40468,
"9-Oct-10":40461,
"2-Oct-10":40454,
"25-Sep-10":40447,
"18-Sep-10":40440,
"11-Sep-10":40433,
"4-Sep-10":40426,
"28-Aug-10":40419,
"21-Aug-10":40412,
"14-Aug-10":40405,
"7-Aug-10":40398,
"31-Jul-10":40391,
"24-Jul-10":40384,
"17-Jul-10":40377,
"10-Jul-10":40370,
"3-Jul-10":40363,
"26-Jun-10":40356,
"19-Jun-10":40349,
"12-Jun-10":40342,
"5-Jun-10":40335,
"29-May-10":40328,
"22-May-10":40321,
"15-May-10":40314,
"8-May-10":40307,
"1-May-10":40300,
"24-Apr-10":40293,
"17-Apr-10":40286,
"10-Apr-10":40279,
"3-Apr-10":40272,
"27-Mar-10":40265,
"20-Mar-10":40258,
"13-Mar-10":40251,
"6-Mar-10":40244,
"27-Feb-10":40237,
"20-Feb-10":40230,
"13-Feb-10":40223,
"6-Feb-10":40216,
"30-Jan-10":40209,
"23-Jan-10":40202,
"16-Jan-10":40195,
"9-Jan-10":40188,
"2-Jan-10":40181,
"26-Dec-09":40174,
"19-Dec-09":40167,
"12-Dec-09":40160,
"5-Dec-09":40153,
"28-Nov-09":40146,
"21-Nov-09":40139,
"14-Nov-09":40132,
"7-Nov-09":40125,
"31-Oct-09":40118,
"24-Oct-09":40111,
"17-Oct-09":40104,
"10-Oct-09":40097,
"3-Oct-09":40090,
"26-Sep-09":40083,
"19-Sep-09":40076,
"12-Sep-09":40069,
"5-Sep-09":40062,
"29-Aug-09":40055,
"22-Aug-09":40048,
"15-Aug-09":40041,
"8-Aug-09":40034,
"1-Aug-09":40027,
"25-Jul-09":40020,
"18-Jul-09":40013,
"11-Jul-09":40006,
"4-Jul-09":39999,
"27-Jun-09":39992,
"20-Jun-09":39985,
"13-Jun-09":39978,
"6-Jun-09":39971,
"30-May-09":39964,
"23-May-09":39957,
"16-May-09":39950,
"9-May-09":39943,
"2-May-09":39936,
"25-Apr-09":39929,
"18-Apr-09":39922,
"11-Apr-09":39915,
"4-Apr-09":39908,
"28-Mar-09":39901,
"21-Mar-09":39894,
"14-Mar-09":39887,
"7-Mar-09":39880,
"28-Feb-09":39873,
"21-Feb-09":39866,
"14-Feb-09":39859,
"7-Feb-09":39852,
"31-Jan-09":39845,
"24-Jan-09":39838,
"17-Jan-09":39831,
"10-Jan-09":39824,
"3-Jan-09":39817,
"27-Dec-08":39810,
"20-Dec-08":39803,
"13-Dec-08":39796,
"6-Dec-08":39789,
"29-Nov-08":39782,
"22-Nov-08":39775,
"15-Nov-08":39768,
"8-Nov-08":39761,
"1-Nov-08":39754,
"25-Oct-08":39747,
"18-Oct-08":39740,
"11-Oct-08":39733,
"4-Oct-08":39726,
"27-Sep-08":39719,
"20-Sep-08":39712,
"13-Sep-08":39705,
"6-Sep-08":39698,
"30-Aug-08":39691,
"23-Aug-08":39684,
"16-Aug-08":39677,
"9-Aug-08":39670,
"2-Aug-08":39663,
"26-Jul-08":39656,
"19-Jul-08":39649,
"12-Jul-08":39642,
"5-Jul-08":39635,
"28-Jun-08":39628,
"21-Jun-08":39621,
"14-Jun-08":39614,
"7-Jun-08":39607,
"31-May-08":39600,
"24-May-08":39593,
"17-May-08":39586,
"10-May-08":39579,
"3-May-08":39572,
"26-Apr-08":39565,
"19-Apr-08":39558,
"12-Apr-08":39551,
"5-Apr-08":39544,
"29-Mar-08":39537,
"22-Mar-08":39530,
"15-Mar-08":39523,
"8-Mar-08":39516,
"1-Mar-08":39509,
"23-Feb-08":39502,
"16-Feb-08":39495,
"9-Feb-08":39488,
"2-Feb-08":39481,
"26-Jan-08":39474,
"19-Jan-08":39467,
"12-Jan-08":39460,
"5-Jan-08":39453,
"29-Dec-07":39446,
"22-Dec-07":39439,
"15-Dec-07":39432,
"8-Dec-07":39425,
"1-Dec-07":39418,
"24-Nov-07":39411,
"17-Nov-07":39404,
"10-Nov-07":39397,
"3-Nov-07":39390,
"27-Oct-07":39383,
"20-Oct-07":39376,
"13-Oct-07":39369,
"6-Oct-07":39362,
"29-Sep-07":39355,
"22-Sep-07":39348,
"15-Sep-07":39341,
"8-Sep-07":39334,
"1-Sep-07":39327,
"25-Aug-07":39320,
"18-Aug-07":39313,
"11-Aug-07":39306,
"4-Aug-07":39299,
"28-Jul-07":39292,
"21-Jul-07":39285,
"14-Jul-07":39278,
"7-Jul-07":39271,
"30-Jun-07":39264,
"23-Jun-07":39257,
"16-Jun-07":39250,
"9-Jun-07":39243,
"2-Jun-07":39236,
"26-May-07":39229,
"19-May-07":39222,
"12-May-07":39215,
"5-May-07":39208,
"28-Apr-07":39201,
"21-Apr-07":39194,
"14-Apr-07":39187,
"7-Apr-07":39180,
"31-Mar-07":39173,
"24-Mar-07":39166,
"17-Mar-07":39159,
"10-Mar-07":39152,
"3-Mar-07":39145,
"24-Feb-07":39138,
"17-Feb-07":39131,
"10-Feb-07":39124,
"3-Feb-07":39117,
"27-Jan-07":39110,
"20-Jan-07":39103,
"13-Jan-07":39096,
"6-Jan-07":39089,
"30-Dec-06":39082,
"23-Dec-06":39075,
"16-Dec-06":39068,
"9-Dec-06":39061,
"2-Dec-06":39054,
"25-Nov-06":39047,
"18-Nov-06":39040,
"11-Nov-06":39033,
"4-Nov-06":39026,
"28-Oct-06":39019,
"21-Oct-06":39012,
"14-Oct-06":39005,
"7-Oct-06":38998,
"30-Sep-06":38991,
"23-Sep-06":38984,
"16-Sep-06":38977,
"9-Sep-06":38970,
"2-Sep-06":38963,
"26-Aug-06":38956,
"19-Aug-06":38949,
"12-Aug-06":38942,
"5-Aug-06":38935,
"29-Jul-06":38928,
"22-Jul-06":38921,
"15-Jul-06":38914,
"8-Jul-06":38907,
"1-Jul-06":38900,
"24-Jun-06":38893,
"17-Jun-06":38886,
"10-Jun-06":38879,
"3-Jun-06":38872,
"27-May-06":38865,
"20-May-06":38858,
"13-May-06":38851,
"6-May-06":38844,
"29-Apr-06":38837,
"22-Apr-06":38830,
"15-Apr-06":38823,
"8-Apr-06":38816,
"1-Apr-06":38809,
"25-Mar-06":38802,
"18-Mar-06":38795,
"11-Mar-06":38788,
"4-Mar-06":38781,
"25-Feb-06":38774,
"18-Feb-06":38767,
"11-Feb-06":38760,
"4-Feb-06":38753,
"28-Jan-06":38746,
"21-Jan-06":38739,
"14-Jan-06":38732,
"7-Jan-06":38725,
"31-Dec-05":38718,
"24-Dec-05":38711,
"17-Dec-05":38704,
"10-Dec-05":38697,
"3-Dec-05":38690,
"26-Nov-05":38683,
"19-Nov-05":38676,
"12-Nov-05":38669,
"5-Nov-05":38662,
"29-Oct-05":38655,
"22-Oct-05":38648,
"15-Oct-05":38641,
"8-Oct-05":38634,
"1-Oct-05":38627,
"24-Sep-05":38620,
"17-Sep-05":38613,
"10-Sep-05":38606,
"3-Sep-05":38599,
"27-Aug-05":38592,
"20-Aug-05":38585,
"13-Aug-05":38578,
"6-Aug-05":38571,
"30-Jul-05":38564,
"23-Jul-05":38557,
"16-Jul-05":38550,
"9-Jul-05":38543,
"2-Jul-05":38536,
"25-Jun-05":38529,
"18-Jun-05":38522,
"11-Jun-05":38515,
"4-Jun-05":38508,
"28-May-05":38501,
"21-May-05":38494,
"14-May-05":38487,
"7-May-05":38480,
"30-Apr-05":38473,
"23-Apr-05":38466,
"16-Apr-05":38459,
"9-Apr-05":38452,
"2-Apr-05":38445,
"26-Mar-05":38438,
"19-Mar-05":38431,
"12-Mar-05":38424,
"5-Mar-05":38417,
"26-Feb-05":38410,
"19-Feb-05":38403,
"12-Feb-05":38396,
"5-Feb-05":38389,
"29-Jan-05":38382,
"22-Jan-05":38375,
"15-Jan-05":38368,
"8-Jan-05":38361,
"1-Jan-05":38354,
"25-Dec-04":38347,
"18-Dec-04":38340,
"11-Dec-04":38333,
"4-Dec-04":38326,
"27-Nov-04":38319,
};



for (week in weeks) {
    var url = 'http://www.vgchartz.com/weekly/' + weeks[week];

request(url, (function(week) { return function(err, resp, body){
    if(!err && resp.statusCode == 200){
        $ = cheerio.load(body);
        $('table.chart tr', '#chart_body').each(function(){
              var rank = $(this).text().trim().replace(/\s\s+/g, ';').replace("Shooter","; Shooter").replace("Sports","; Sports").replace("Action","; Action").replace("Role-Playing","; Role-Playing").replace("Racing","; Racing").replace("Platform","; Platform").replace("Misc","; Misc").replace("Adventure","; Adventure").replace("Simulation","; Simulation").replace("Puzzle","; Puzzle").replace("Strategy","; Strategy").replace("Fighting","; Fighting").replace("(DS)",";DS;").replace("(3DS)",";3DS;").replace("(PS3)",";PS3;").replace("(PS4)",";PS4;").replace("(PSP)",";PSP;").replace("(PSV)",";PSV;").replace("(Wii)",";Wii;").replace("(WiiU)",";WiiU;").replace("(X360)",";X360;").replace("(XOne)",";XOne;").replace("(PC)",";PC;");
                          chart.push(week + ';' +rank);

        fs.writeFile('output.txt', JSON.stringify(chart, null, 4), function(){

        console.log(chart);

        });


        });
    }
};
})(week));


}


//remove parentheses with: .replace(/\(|\)/g, '; ')